<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Page</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/nav-top-style.css">
    <link rel="stylesheet" href="/css/nav-circular.css">
    <link rel="stylesheet" href="/css/header-style.css">
    <link rel="stylesheet" href="/css/index-style.css">
    <link rel="stylesheet" href="/css/cookies-style.css">
    <link rel="stylesheet" href="/css/feedback-style.css">
    <link rel="stylesheet" href="/css/project-style.css">


    <style>
        /* Add your custom styles here */
        .project-form {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f7f7f7;
            border-radius: 8px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
        }

        .project-form label {
            display: block;
            margin-bottom: 6px;
            font-weight: bold;
        }

        .project-form input {
            width: 100%;
            padding: 10px;
            margin-bottom: 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .project-form button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 10px 20px;
            cursor: pointer;
        }

        .project-form button:hover {
            background-color: #0056b3;
        }
        body {
            background: linear-gradient(0.25turn, #6492a6, #8bb0c2, #1a5f6e);
        }
        .sidebar {
            background-color: #343a40;
            color: #fff;
            height: 100vh;
        }
        .content {
            padding: 20px;
        }
    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        <nav class="col-md-3 col-lg-2 d-none d-md-block sidebar">
            <div class="position-sticky">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link active" style="color: white" href="/admin">
                            Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" style="color: white" href="/admin/bilder">
                            Bilder Uplaod protal
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" style="color: white" href="/admin/projekte">
                            Projekte
                        </a>
                    </li>
                    <!-- Add more navigation items here -->
                </ul>
            </div>
        </nav>
        <!-- Content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 content">
           <h1>Projekte Protal </h1>
            <form th:object="${projekt}" th:action="@{/admin/projekte}" method="post" class="project-form" style="margin-top: 100px"
                  enctype="multipart/form-data">
                <h4>Neues Projekt hinzufügen</h4>
                <label for="name">Projektnamen:</label>
                <input type="text" id="name" name="name" required/>

                <label for="status">Projektstatus: (zahl eingeben )</label>
                <input type="text" id="status" name="status" required/>

                <label for="details">Projektdetails:</label>
                <input type="text" id="details" name="details" required/>

                <label for="beschreibung">Projektbeschreibung:</label>
                <input type="text" id="beschreibung" name="beschreibung" required/>

                <label >Projektbild:</label>
                <input type="file" name="pictureFile" accept="image/*" class="form-control">
                <button type="submit">Projekt hinzufügen</button>
            </form>

<hr>


            <div class="scrollable-container" th:each="projekt : ${projekte}">
                <div class="scrollable-list" >
                    <div class="card" >
                        <img th:if="${projekt.logo}"
                             th:src="@{/admin/projekte/image/{projectId}(projectId=${projekt.id})}" alt="Projekt Bild"
                             style="width: 100%; height: 150px">
                        <div class="card-body">
                            <h5 class="card-title" th:text="${projekt.name}">Project A</h5>
                            <p>Status: <span class="status status-in-progress" th:text="${projekt.details}"></span></p>
                            <p class="card-text" th:text="${projekt.beschreibung}">My project description</p>
                        </div>
                        <div class="card-footer">
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" th:style="'width: ' + ${projekt.status} + '%'" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
                            </div> <p  th:text="${projekt.status} +'%'">%</p>
                            <div class="row">
                                <p>Status: <span class="status status-in-progress" th:text="${projekt.details}"></span></p>
                            </div>
                        </div>
                        <div class="pad-btm" style="margin-left: 30px">
                            <div  class="d-inline-block mr-2">
                                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#editModal">Edit Project</button>
                                <form th:action="@{'/admin/project/delete/' + ${projekt.id}}" method="post" class="btn">
                                    <input type="hidden" name="_method" value="DELETE" />
                                    <button type="submit" class="btn btn-danger" onclick="deleteProject()">Delete Project</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Modal -->
                <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <!-- Hier können Sie den Inhalt Ihres Modals platzieren -->
                            <!-- Beispielinhalt: Ein Formular zum Bearbeiten der Daten -->
                            <form th:object="${projekt}" th:action="@{'/admin/project/edit/'+${projekt.id}}" method="post" class="project-form" style="margin-top: 100px"
                                  >
                                <input type="hidden" name="_method" value="POST" />
                                <div class="modal-header">
                                    <h5 class="modal-title" id="editModalLabel">Edit Project</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <!-- Hier können Sie Ihre Formularelemente für die Bearbeitung platzieren -->
                                    <!-- Beispiel: -->
                                    <label for="Projekname">Projektnamen:</label>
                                    <input type="text" id="Projekname" name="name" th:value="${projekt.name}"/>
                                    <hr>
                                    <label for="Projekstatus">Projektstatus: (zahl eingeben )</label>
                                    <input type="text" id="Projekstatus" name="status" th:value="${projekt.status}"/>
                                    <hr>
                                    <label for="Projekdetails">Projektdetails:</label>
                                    <input type="text" id="Projekdetails" name="details" th:value="${projekt.details}"/>
                                    <hr>
                                    <label for="Projekbeschreibung">Projektbeschreibung:</label>
                                    <input type="text" id="Projekbeschreibung" name="beschreibung" th:value="${projekt.beschreibung}"/>

                                    <!-- Weitere Formularelemente hier -->
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-primary">Save changes</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>

<script>
    function deleteProject() {
        if (confirm('Are you sure you want to delete this project?')) {
            var form = document.getElementById('deleteForm');
            var xhr = new XMLHttpRequest();

            xhr.open('POST', form.getAttribute('action'), true);
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');

            xhr.onload = function() {
                if (xhr.status === 200) {
                    // Handle success, e.g., update the UI
                    alert('Project deleted successfully');
                    // Optionally, you can redirect or update the page here
                } else {
                    // Handle errors, e.g., display an error message
                    alert('An error occurred while deleting the project');
                }
            };

            xhr.send(''); // Send the POST request
        }
    }
</script>
<!-- Include Bootstrap JS and Popper.js for dropdowns and other interactive components -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/project-script.js"></script>
</body>
</html>